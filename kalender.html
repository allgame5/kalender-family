<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vollständiger Kalender mit Firebase</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f4f4f9;
    }
    .calendar-container {
      width: 100%;
      max-width: 600px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.5em;
    }
    .calendar-weekdays, .calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
      margin-top: 10px;
    }
    .calendar-weekdays div, .calendar-days div {
      padding: 10px;
    }
    .calendar-day {
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.2s ease;
    }
    .calendar-day:hover {
      background-color: #90caf9;
    }
    .selected-day {
      background-color: #1976d2;
      color: white;
    }
    #event-form {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    #event-form input {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    #event-form button {
      padding: 10px 20px;
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="calendar-container">
  <div class="calendar-header">
    <button id="prev-month">←</button>
    <span id="current-month"></span>
    <button id="next-month">→</button>
  </div>

  <div class="calendar-weekdays">
    <div>Mo</div>
    <div>Di</div>
    <div>Mi</div>
    <div>Do</div>
    <div>Fr</div>
    <div>Sa</div>
    <div>So</div>
  </div>

  <div class="calendar-days"></div>
</div>

<div id="event-form">
  <h3>Neues Ereignis hinzufügen</h3>
  <input type="text" id="event-name" placeholder="Ereignisname" />
  <button id="save-event">Speichern</button>
</div>

<script>
  // Firebase-Konfiguration
  const firebaseConfig = {
    apiKey: "AIzaSyAbvF26pw-NVQGW1lMmNCW3avQllWXylpY",
  authDomain: "kalender-3da21.firebaseapp.com",
  projectId: "kalender-3da21",
  storageBucket: "kalender-3da21.firebasestorage.app",
  messagingSenderId: "731037868090",
  appId: "1:731037868090:web:02ac820fbb8bb9abd21503",
  measurementId: "G-DTYRKLSD4L"
  };

  // Firebase initialisieren
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database(app);

  // Aktuelles Datum
  let currentMonth = new Date().getMonth();
  let currentYear = new Date().getFullYear();
  const monthNames = ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"];

  // Kalender rendern
  function renderCalendar() {
    const daysContainer = document.querySelector('.calendar-days');
    const currentMonthElement = document.getElementById('current-month');
    currentMonthElement.innerText = `${monthNames[currentMonth]} ${currentYear}`;

    const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

    // Leere Zellen für den ersten Tag des Monats
    daysContainer.innerHTML = '';
    for (let i = 0; i < firstDayOfMonth; i++) {
      const emptyCell = document.createElement('div');
      daysContainer.appendChild(emptyCell);
    }

    // Tage des Monats rendern
    for (let day = 1; day <= daysInMonth; day++) {
      const dayCell = document.createElement('div');
      dayCell.classList.add('calendar-day');
      dayCell.innerText = day;
      dayCell.addEventListener('click', () => showEventForm(day));
      daysContainer.appendChild(dayCell);
    }
  }

  // Ereignisformular anzeigen
  function showEventForm(day) {
    const eventForm = document.getElementById('event-form');
    eventForm.style.display = 'block';

    document.getElementById('save-event').onclick = function() {
      const eventName = document.getElementById('event-name').value;
      if (eventName) {
        const eventId = Date.now(); // Verwende eine eindeutige ID für jedes Ereignis
        const dateString = `${currentYear}-${currentMonth + 1}-${day}`;

        db.ref('events').child(dateString).child(eventId).set({
          name: eventName,
          id: eventId
        });

        eventForm.style.display = 'none';
        renderCalendar();
      }
    };
  }

  // Monat wechseln
  document.getElementById('prev-month').addEventListener('click', () => {
    currentMonth--;
    if (currentMonth < 0) {
      currentMonth = 11;
      currentYear--;
    }
    renderCalendar();
  });

  document.getElementById('next-month').addEventListener('click', () => {
    currentMonth++;
    if (currentMonth > 11) {
      currentMonth = 0;
      currentYear++;
    }
    renderCalendar();
  });

  // Initiale Kalenderdarstellung
  renderCalendar();
</script>

</body>
</html>
